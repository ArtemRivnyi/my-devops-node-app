# My DevOps Node.js App

## Демонстрационный Проект DevOps: Контейнеризированное Веб-Приложение с Локальным CI/CD

Этот проект служит практической демонстрацией ключевых навыков DevOps, охватывающих разработку веб-приложений, контейнеризацию и автоматизацию CI/CD для локальной среды.

### **Цели проекта:**

* Разработать простое веб-приложение на Node.js с использованием Express.js.
* Контейнеризовать приложение с использованием Docker для обеспечения переносимости и изоляции.
* Настроить автоматизированный CI/CD пайплайн для локальной среды, включающий сборку Docker-образа и запуск контейнера.
* Продемонстрировать понимание принципов облачного развертывания и мониторинга (концептуально).

### **Используемые технологии и практики:**

* **Node.js & Express.js**: Для разработки легковесного веб-сервера.
* **HTML & CSS**: Для создания пользовательского интерфейса.
* **Docker**: Для контейнеризации приложения, обеспечения переносимости и изоляции.
* **PowerShell**: Для автоматизации локального CI/CD пайплайна (сборка, запуск).
* **Git & GitHub**: Для управления версиями исходного кода и хостинга репозитория.
* **morgan (Node.js middleware)**: Для HTTP-логирования запросов в консоль приложения.
* **Mocha & Chai**: (Опционально/Заготовка) Фреймворк для тестирования и библиотека для утверждений, предназначенные для юнит-тестирования приложения.

### **Структура проекта:**

my-devops-node-app/
├── .git/                               # Папка Git-репозитория
├── .github/                            # Конфигурация GitHub Actions (для будущих шагов с облаком)
│   └── workflows/
│       └── main.yml                    # Заготовка для CI/CD пайплайна GitHub Actions
├── ansible/                            # (Опционально) Пример использования Ansible
├── node_modules/                       # Установленные зависимости Node.js
├── public/                             # Статические файлы (HTML, CSS)
│   ├── index.html
│   ├── about.html
│   ├── contact.html
│   └── style.css
├── test/                               # Заготовка для файлов с тестами
│   └── app.test.js
├── .dockerignore                       # Файлы и папки, игнорируемые при сборке Docker-образа
├── deploy_local.ps1                    # PowerShell скрипт для локального CI/CD пайплайна
├── docker-compose.yml                  # Пример определения сервисов Docker Compose (не используется в текущем локальном пайплайне)
├── Dockerfile                          # Инструкции для сборки Docker-образа
├── index.js                            # Основной файл приложения Node.js
├── package.json                        # Описание проекта и его зависимостей
├── package-lock.json                   # Заблокированные версии зависимостей
└── README.md                           # Этот файл


### **Запуск приложения локально (с Локальным CI/CD пайплайном):**

Этот пайплайн автоматизирует сборку Docker-образа и запуск контейнера на вашей локальной машине.

1.  **Клонируйте репозиторий** (если вы еще этого не сделали):
    ```bash
    git clone [https://github.com/ВАШ_НИКНЕЙМ/my-devops-node-app.git](https://github.com/ВАШ_НИКНЕЙМ/my-devops-node-app.git)
    cd my-devops-node-app
    ```
    *(Замените `ВАШ_НИКНЕЙМ` на ваш реальный никнейм на GitHub)*

2.  **Убедитесь, что Docker Desktop запущен** на вашем компьютере.

3.  **Запустите локальный CI/CD пайплайн** с помощью PowerShell:
    * Откройте **обычное** окно PowerShell (не от имени администратора).
    * Перейдите в корневую директорию проекта (если вы не в ней):
        ```powershell
        cd C:\path\to\my-devops-node-app # Замените на реальный путь к вашему проекту
        ```
    * Выполните скрипт:
        ```powershell
        .\deploy_local.ps1
        ```
        *(Если PowerShell выдает ошибку "Имя '.\deploy_local.ps1' не распознано...", вам нужно будет изменить политику выполнения скриптов. Откройте PowerShell **от имени администратора** и выполните `Set-ExecutionPolicy RemoteSigned`, подтвердите действие, затем закройте окно администратора и повторите запуск скрипта в обычном PowerShell.)*

4.  После успешного выполнения скрипта, ваше приложение будет доступно по адресу:
    [http://localhost:3000/](http://localhost:3000/)

### **Мониторинг и Логирование (локально):**

* Чтобы просмотреть логи работающего контейнера в реальном времени (например, данные из формы), откройте **новое** окно PowerShell и выполните:
    ```powersels
    docker logs my-node-app-container -f
    ```
* Эти логи отображают вывод `console.log` из вашего Node.js приложения, включая информацию о запросах (благодаря `morgan`) и данные из формы обратной связи.

### **Управление локальным контейнером:**

* Чтобы остановить запущенный контейнер (когда он больше не нужен и чтобы освободить порт 3000):
    ```powershell
    docker stop my-node-app-container
    ```
* Чтобы удалить контейнер (после остановки):
    ```powershell
    docker rm my-node-app-container
    ```
* Чтобы удалить образ (после удаления контейнера):
    ```powershell
    docker rmi my-node-webapp-local
    ```

### **Концептуальное Облачное Развертывание (без фактических затрат):**

Хотя этот проект в текущей конфигурации не развернут в реальной облачной среде из-за фокуса на локальный DevOps, ниже описан подход, который был бы использован для развертывания.

#### **Подготовка Облачной Платформы (например, Google Cloud Platform):**

* **Проект:** Создание или выбор проекта в GCP.
* **API:** Включение необходимых API (Cloud Run API, Artifact Registry API, Service Usage API).
* **Сервисный аккаунт:** Создание сервисного аккаунта с минимальными необходимыми разрешениями (`Cloud Run Admin`, `Artifact Registry Writer`, `Service Account User`).
* **Репозиторий образов:** Создание репозитория Docker в Google Artifact Registry.

#### **Провизионирование Сервиса (например, Google Cloud Run):**

* **Развертывание контейнера:** Использование Cloud Run для запуска контейнера из образа, хранящегося в Artifact Registry. Cloud Run автоматически масштабирует приложение, обрабатывает запросы и предоставляет публичный URL.
* **Конфигурация:** Настройка переменных окружения, лимитов памяти/CPU, и других параметров.

#### **Мониторинг и Логирование (в облаке):**

* В облачной среде (например, Google Cloud) логи приложения, выводимые в stdout/stderr контейнера, автоматически собираются сервисом **Cloud Logging**.
* Метрики производительности (количество запросов, задержки, использование CPU/памяти) автоматически отслеживаются в **Cloud Monitoring**, где можно настраивать дашборды и оповещения.

### **Следующие шаги для развития проекта:**

* **Добавить полноценные тесты**: Реализовать юнит- и/или интеграционные тесты с использованием Mocha/Chai для Node.js приложения и интегрировать их в `deploy_local.ps1` или в будущий CI/CD пайплайн.
* **Интегрировать Docker Compose**: Обновить `deploy_local.ps1` для использования `docker-compose up -d --build` для управления приложением, что полезно для многокомпонентных проектов.
* **Расширить CI/CD на облако**: Настроить реальный CI/CD пайплайн с GitHub Actions для автоматического развертывания Docker-образа в облаке (например, Google Cloud Run или AWS EC2) при каждом push в репозиторий.
* **Интегрировать реальные инструменты мониторинга и логирования**: Для облачного развертывания настроить автоматический сбор логов и расширенный мониторинг через соответствующие облачные сервисы (например, Google Cloud Logging/Monitoring, AWS CloudWatch).
